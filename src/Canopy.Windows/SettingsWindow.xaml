<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="Canopy.Windows.SettingsWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Canopy.Windows"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Title="Canopy Settings">

    <Window.SystemBackdrop>
        <MicaBackdrop />
    </Window.SystemBackdrop>

    <Grid Padding="24">
        <ScrollViewer>
            <StackPanel Spacing="16">
                <!-- Header -->
                <TextBlock Text="Settings" Style="{StaticResource TitleTextBlockStyle}" Margin="0,0,0,8"/>

                <!-- General Settings -->
                <StackPanel Spacing="12">
                    <TextBlock Text="General" Style="{StaticResource SubtitleTextBlockStyle}"/>
                    
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Start with Windows"/>
                            <TextBlock Text="Launch Canopy when you sign in" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                        </StackPanel>
                        <ToggleSwitch x:Name="StartWithWindowsToggle" Grid.Column="1" Toggled="StartWithWindowsToggle_Toggled"/>
                    </Grid>
                    <Grid x:Name="StartOpenGrid">
                      <Grid.ColumnDefinitions>
                      <ColumnDefinition Width="*"/>
              <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            <StackPanel>
              <TextBlock Text="Open on Startup"/>
              <TextBlock Text="Show Canopy when your computer starts up" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
            </StackPanel>
            <ToggleSwitch x:Name="StartOpenToggle" Grid.Column="1" Toggled="StartOpenToggle_Toggled"/>
          </Grid>

          <Grid>
            <Grid.ColumnDefinitions>
                             <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/> 
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Auto-update"/>
                            <TextBlock Text="Automatically download and install updates" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                        </StackPanel>
                        <ToggleSwitch x:Name="AutoUpdateToggle" Grid.Column="1" Toggled="AutoUpdateToggle_Toggled"/>
                    </Grid>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Check for updates"/>
                            <TextBlock x:Name="UpdateStatusText" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12" Visibility="Collapsed"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" Grid.Column="1" Spacing="8">
                            <Button x:Name="UpdateNowButton" Content="Update Now" Click="UpdateNowButton_Click" Visibility="Collapsed"
                                    Style="{ThemeResource AccentButtonStyle}"/>
                            <Button x:Name="CheckUpdatesButton" Content="Check Now" Click="CheckUpdatesButton_Click"/>
                        </StackPanel>
                    </Grid>
                    
                    <!-- Update Progress -->
                    <StackPanel x:Name="UpdateProgressPanel" Visibility="Collapsed" Spacing="4">
                        <ProgressBar x:Name="UpdateProgressBar" Minimum="0" Maximum="100" Value="0"/>
                        <TextBlock x:Name="UpdateProgressText" Text="Downloading..." Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                    </StackPanel>
                </StackPanel>

                <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" Margin="0,8"/>

                <!-- Overlay Settings -->
                <StackPanel Spacing="12">
                    <TextBlock Text="Overlay" Style="{StaticResource SubtitleTextBlockStyle}"/>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Enable overlay"/>
                            <TextBlock Text="Show the floating overlay window" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                        </StackPanel>
                        <ToggleSwitch x:Name="EnableOverlayToggle" Grid.Column="1" Toggled="EnableOverlayToggle_Toggled"/>
                    </Grid>

                    <Grid x:Name="CompactOverlayGrid">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Compact mode"/>
                            <TextBlock Text="Use smaller toolbar-style overlay" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                        </StackPanel>
                        <ToggleSwitch x:Name="CompactOverlayToggle" Grid.Column="1" Toggled="CompactOverlayToggle_Toggled"/>
                    </Grid>

                    <Grid x:Name="OverlayShortcutGrid">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Toggle shortcut"/>
                            <TextBlock Text="Keyboard shortcut to show/hide overlay" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                        </StackPanel>
                        <TextBox x:Name="OverlayShortcutTextBox" Grid.Column="1" Width="150" IsReadOnly="True"
                                 GotFocus="ShortcutTextBox_GotFocus" LostFocus="ShortcutTextBox_LostFocus"
                                 PreviewKeyDown="OverlayShortcutTextBox_PreviewKeyDown"/>
                    </Grid>

                    <Grid x:Name="DragShortcutGrid">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel>
                            <TextBlock Text="Drag shortcut"/>
                            <TextBlock Text="Hold to drag the overlay" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                        </StackPanel>
                        <TextBox x:Name="DragShortcutTextBox" Grid.Column="1" Width="150" IsReadOnly="True"
                                 GotFocus="ShortcutTextBox_GotFocus" LostFocus="ShortcutTextBox_LostFocus"
                                 PreviewKeyDown="DragShortcutTextBox_PreviewKeyDown"/>
                    </Grid>

                    <Button x:Name="ResetOverlayPositionButton" Content="Reset Overlay Position" Click="ResetOverlayPositionButton_Click"/>
                </StackPanel>

                <Rectangle Height="1" Fill="{ThemeResource DividerStrokeColorDefaultBrush}" Margin="0,8"/>

                <!-- Footer -->
                <StackPanel Spacing="8" Margin="0,8,0,0">
                    <TextBlock x:Name="VersionText" Foreground="{ThemeResource TextFillColorSecondaryBrush}" FontSize="12"/>
                    <Button x:Name="CloseButton" Content="Close" HorizontalAlignment="Right" Click="CloseButton_Click"/>
                </StackPanel>
            </StackPanel>
        </ScrollViewer>
    </Grid>
</Window>
